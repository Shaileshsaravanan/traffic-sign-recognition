# Traffic Signs Detection and Classification in Real-Time

A new and improved version using Single Shot MultiBox Detector (SSD) is set to be released this summer. This update will provide higher accuracy for those who require a more precise detection method. Stay tuned for upcoming releases!

## 1. Project Overview

This project focuses on the real-time detection and classification of traffic signs in videos using OpenCV. The system is divided into two main phases: **detection** and **classification**.

### Detection Phase:

In the detection phase, Image Processing techniques are applied to each video frame to identify potential traffic signs. The steps involved include:

1. **Enhance Contrast**: Increase the contrast and dynamic range of the video frame.
2. **Color Filtering**: Remove unnecessary colors, such as green, using HSV color range.
3. **Edge Detection**: Apply the Laplacian of Gaussian to highlight object borders.
4. **Contour Creation**: Binarize the frame to create contours.
5. **Shape Detection**: Identify ellipse-like and circle-like contours as potential traffic sign candidates.

### Classification Phase:

In the classification phase, the identified candidates are cropped from the original frame. A pre-trained SVM model is then used to classify these images and determine the specific type of traffic sign.

**Currently Supported Traffic Signs:**

- The project supports multiple classes of traffic signs, with some grouped under "OTHERS" due to competition requirements.
- A special class (Class 0) is used for non-traffic-signs.

**Tracking and Model Details:**

- The system tracks detected traffic signs using Dense Optical Flow until they disappear or are replaced by a larger sign in the frame.
- The SVM model is trained each time `main.py` is run. The model is saved in `data_svm.dat` to enable future implementation of a model-reload function, avoiding the need for retraining each time.

## 2. Prerequisites

Ensure that you have the following dependencies installed:

- Python 3.5
- OpenCV 3
- Imutils (`pip3 install imutils`)

## 3. System Structure

### a. Python Files:

The system consists of three primary Python modules:

- **`main.py`**: The entry point of the program.
- **`classification.py`**: Contains the SVM model used to classify traffic signs.
- **`common.py`**: Provides utility functions for defining the SVM model.
- **`data_svm.dat`**: Stores the trained SVM model.

### c. Dataset:

The `Dataset` folder contains images for training the SVM model. This folder is divided into 12 subfolders, each corresponding to a specific traffic sign class. The special `0` folder contains non-traffic-sign images that might be mistakenly detected as traffic signs.

The dataset is generated by applying the detection phase to various videos and manually categorizing the detected traffic signs into their appropriate classes. Each time the program is run, the dataset can be updated by checking and correcting any misclassified traffic signs.

## 4. Installation

You can run the program in two ways:

### Using Default Arguments:

```bash
python3 main/main.py
```

### Using Custom Arguments:

```bash
python3 main/main.py [options]
```

#### Optional Arguments:

- `-h, --help`: Show help message and exit.
- `--file_name FILE_NAME`: Specify the video file to be analyzed.
- `--min_size_components MIN_SIZE_COMPONENTS`: Set the minimum size component to be reserved.
- `--similarity_contour_with_circle SIMILARITY_CONTOUR_WITH_CIRCLE`: Set the similarity threshold to a circle.

## 5. Results

The system outputs the detected and classified traffic signs in real-time as it processes the video.

## 6. Limitations

- **Static Image Processing**: Parameters need to be updated for each video with different lighting conditions.
- **Detection Accuracy**: The detection phase may miss signs or detect incorrect areas.
- **Overfitting**: The dataset is slightly overfitted, which may affect the classification phase.

## 7. Future Developments

- Improve performance with higher frame rates.
- Explore other detection methods like YOLO or SSD.
- Implement dynamic image processing techniques.
- Incorporate CNNs for classification.
- Remove the need for retraining the model each time the program is run.
- Expand and diversify the dataset.

## 8. Project Structure

The codebase is organized into three main folders:

- **`main/`**: Contains the main program files.
- **`test/`**: Includes testing scripts and files.
- **`train/`**: Holds the training scripts and dataset.